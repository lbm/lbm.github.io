<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.23.0"/><meta data-react-helmet="true" name="description" content="AWS GuardDuty  is a managed threat detection service that monitors malicious or unauthorized behaviors/activities related to AWS resources…"/><meta data-react-helmet="true" name="image" content="https://lachlan.io/static/21c395f49fe8e6e9735693b07fce1c86/a6c62/integrating-aws-guardduty-with-microsoft-teams.jpg"/><meta data-react-helmet="true" property="og:title" content="Integrating AWS GuardDuty with Microsoft Teams"/><meta data-react-helmet="true" property="og:url" content="https://lachlan.io/blog/integrating-aws-guardduty-with-microsoft-teams"/><meta data-react-helmet="true" property="og:description" content="AWS GuardDuty  is a managed threat detection service that monitors malicious or unauthorized behaviors/activities related to AWS resources…"/><meta data-react-helmet="true" property="og:image" content="https://lachlan.io/static/21c395f49fe8e6e9735693b07fce1c86/a6c62/integrating-aws-guardduty-with-microsoft-teams.jpg"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image:alt" content="AWS GuardDuty  is a managed threat detection service that monitors malicious or unauthorized behaviors/activities related to AWS resources…"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Integrating AWS GuardDuty with Microsoft Teams"/><meta data-react-helmet="true" name="twitter:url" content="https://lachlan.io/blog/integrating-aws-guardduty-with-microsoft-teams"/><meta data-react-helmet="true" name="twitter:description" content="AWS GuardDuty  is a managed threat detection service that monitors malicious or unauthorized behaviors/activities related to AWS resources…"/><meta data-react-helmet="true" name="twitter:image" content="https://lachlan.io/static/21c395f49fe8e6e9735693b07fce1c86/a6c62/integrating-aws-guardduty-with-microsoft-teams.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="AWS GuardDuty  is a managed threat detection service that monitors malicious or unauthorized behaviors/activities related to AWS resources…"/><meta data-react-helmet="true" name="twitter:creator" content="@lachlanmitchell"/><meta data-react-helmet="true" name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog"/><meta name="theme-color" content="#1a202c"/><title data-react-helmet="true">Integrating AWS GuardDuty with Microsoft Teams | Lachlan Mitchell</title><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&amp;display=swap"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="192x192" href="/android-chrome-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/android-chrome-512x512.png"/><link rel="alternate" type="application/rss+xml" title="Lachlan Mitchell" href="/rss.xml"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global 1yc3m30">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#e2e8f0;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-__default,.theme-ui-__default html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#e2e8f0;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#9f7aea;--theme-ui-colors-secondary:#7f8ea3;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;}</style><style data-emotion="css-global 1j0yc2g">*{box-sizing:border-box;}html{font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global h7esfd">*{box-sizing:inherit;}html{-webkit-text-size-adjust:100%;}img{border-style:none;}pre{font-family:monospace;font-size:1em;}[hidden]{display:none;}::selection{background-color:var(--theme-ui-colors-text);color:var(--theme-ui-colors-background);}a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:text;}</style><style data-emotion="css 1gq7j3t">.css-1gq7j3t{border:0;clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1gq7j3t:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading);color:var(--theme-ui-colors-background);z-index:1;width:auto;height:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1gq7j3t">Skip to content</a><style data-emotion="css 1jrqzhj">.css-1jrqzhj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width: 640px){.css-1jrqzhj{padding:2rem;}}</style><div class="css-1jrqzhj"><style data-emotion="css egutgn">.css-egutgn{margin-bottom:4rem;}@media screen and (min-width: 640px){.css-egutgn{margin-bottom:8rem;}}</style><header class="css-egutgn"><style data-emotion="css 1xwyizx">.css-1xwyizx{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><style data-emotion="css 10klvkd">.css-10klvkd{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><div class="css-10klvkd"><style data-emotion="css uxjqfw">.css-uxjqfw{color:var(--theme-ui-colors-heading);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="Lachlan Mitchell - Back to home" class="css-uxjqfw" href="/"><style data-emotion="css 102q2va">.css-102q2va{margin-top:0;margin-bottom:0;font-weight:500;font-size:1.5rem;}@media screen and (min-width: 640px){.css-102q2va{font-size:1.875rem;}}</style><div class="css-102q2va">Lachlan Mitchell</div></a><style data-emotion="css zut31r">.css-zut31r{opacity:0.65;position:relative;border-radius:5px;width:40px;height:25px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;border:none;outline:none;background:none;cursor:pointer;padding:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;}.css-zut31r:hover,.css-zut31r:focus{opacity:1;}</style><button type="button" aria-label="Activate Dark Mode" title="Activate Dark Mode" class="css-zut31r"><style data-emotion="css 1m6u41m">.css-1m6u41m{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);-webkit-transition:all 0.45s ease;transition:all 0.45s ease;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon);}.css-1m6u41m:before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;-webkit-transform:translate(0, 0);-moz-transform:translate(0, 0);-ms-transform:translate(0, 0);transform:translate(0, 0);opacity:1;-webkit-transition:-webkit-transform 0.45s ease;transition:transform 0.45s ease;}.css-1m6u41m:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon),0 23px 0 var(--theme-ui-colors-toggleIcon),23px 0 0 var(--theme-ui-colors-toggleIcon),-23px 0 0 var(--theme-ui-colors-toggleIcon),15px 15px 0 var(--theme-ui-colors-toggleIcon),-15px 15px 0 var(--theme-ui-colors-toggleIcon),15px -15px 0 var(--theme-ui-colors-toggleIcon),-15px -15px 0 var(--theme-ui-colors-toggleIcon);-webkit-transform:scale(0);-moz-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transition:all 0.35s ease;transition:all 0.35s ease;}</style><div class="css-1m6u41m"></div></button></div><style data-emotion="css fp1v3n">.css-fp1v3n{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary);-webkit-box-flex-flow:wrap;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-fp1v3n a{color:var(--theme-ui-colors-secondary);}.css-fp1v3n a:hover{color:var(--theme-ui-colors-heading);}</style><div class="css-fp1v3n"><style data-emotion="css 1lx5s1f">.css-1lx5s1f{font-size:1rem;}.css-1lx5s1f a:not(:last-of-type){margin-right:1rem;}@media screen and (min-width: 640px){.css-1lx5s1f{font-size:18px;}}.css-1lx5s1f .active{color:var(--theme-ui-colors-heading);}</style><nav class="css-1lx5s1f"><style data-emotion="css bpdkdn">.css-bpdkdn{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-bpdkdn:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-bpdkdn" href="/about">About</a><a class="css-bpdkdn" href="/blog">Blog</a></nav><style data-emotion="css 45ghvz">.css-45ghvz{font-size:1rem;}.css-45ghvz a:not(:first-of-type){margin-left:1rem;}@media screen and (min-width: 640px){.css-45ghvz{font-size:18px;}}</style><div class="css-45ghvz"><style data-emotion="css 1fmmdck">.css-1fmmdck{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1fmmdck:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://github.com/lbm" class="css-1fmmdck">GitHub</a><a href="https://www.linkedin.com/in/lachlan-mitchell" class="css-1fmmdck">LinkedIn</a><a href="https://twitter.com/lachlanmitchell" class="css-1fmmdck">Twitter</a></div></div></header><style data-emotion="css 1riy7p1">.css-1riy7p1 [data-name='live-editor']{font-size:1rem;}.css-1riy7p1 [data-name='live-editor'] textarea,.css-1riy7p1 [data-name='live-editor'] pre{padding:1rem!important;}.css-1riy7p1 [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-1riy7p1 .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-1riy7p1 .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-1riy7p1 .prism-code{font-size:1.25rem;}}.css-1riy7p1 .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1riy7p1 .gatsby-highlight[data-language=''] .prism-code,.css-1riy7p1 .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-1riy7p1 .token{display:inline-block;}.css-1riy7p1 p>code,.css-1riy7p1 li>code{background-color:var(--theme-ui-colors-gray-2);color:var(--theme-ui-colors-gray-8);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-1riy7p1 .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1riy7p1 .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1riy7p1 .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1riy7p1 .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1riy7p1 .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1riy7p1 .gatsby-highlight pre code{float:left;min-width:100%;}.css-1riy7p1 .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-1riy7p1 .gatsby-highlight pre[class~="language-javascript"]:before,.css-1riy7p1 .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1riy7p1 .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1riy7p1 .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1riy7p1 .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1riy7p1 .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1riy7p1 .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1riy7p1 .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1riy7p1 .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1riy7p1 .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1riy7p1 .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1riy7p1 .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-1riy7p1 .gatsby-highlight pre[class~="language-py"]:before,.css-1riy7p1 .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-1riy7p1 .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1riy7p1 .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1riy7p1 .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1riy7p1 .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1riy7p1 .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1riy7p1 .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1riy7p1 .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1riy7p1 .gatsby-highlight pre[class~='language-json']:before,.css-1riy7p1 .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1riy7p1 .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1riy7p1 .gatsby-highlight pre[class~='language-hcl']:before{content:'hcl';background:#623ce4;color:var(--theme-ui-colors-white);}.css-1riy7p1 .gatsby-highlight pre[class~='language-sql']:before{content:'sql';background:#e38c00;}.css-1riy7p1 .gatsby-highlight>code[class*="language-"],.css-1riy7p1 .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1riy7p1 .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1riy7p1 .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-1riy7p1 .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1, 22, 39);}.css-1riy7p1 .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1riy7p1 .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1riy7p1 .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1riy7p1 .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1riy7p1 .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-1riy7p1 [data-name='live-preview'],.css-1riy7p1 [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width: 640px){.css-1riy7p1 [data-name='live-preview'],.css-1riy7p1 [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width: 768px){.css-1riy7p1 [data-name='live-preview'],.css-1riy7p1 [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width: 1024px){.css-1riy7p1 [data-name='live-preview'],.css-1riy7p1 [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-1riy7p1 .token-line{padding-right:1rem;}.css-1riy7p1 .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-1riy7p1 .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1riy7p1 .react-live-wrapper{position:relative;}.css-1riy7p1 .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width: 640px){.css-1riy7p1 .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 768px){.css-1riy7p1 .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 1024px){.css-1riy7p1 .react-live-wrapper .code-copy-button{right:-1rem;}}</style><style data-emotion="css 18eyij1">.css-18eyij1{box-sizing:border-box;margin:0;min-width:0;}.css-18eyij1 [data-name='live-editor']{font-size:1rem;}.css-18eyij1 [data-name='live-editor'] textarea,.css-18eyij1 [data-name='live-editor'] pre{padding:1rem!important;}.css-18eyij1 [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-18eyij1 .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-18eyij1 .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-18eyij1 .prism-code{font-size:1.25rem;}}.css-18eyij1 .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-18eyij1 .gatsby-highlight[data-language=''] .prism-code,.css-18eyij1 .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-18eyij1 .token{display:inline-block;}.css-18eyij1 p>code,.css-18eyij1 li>code{background-color:var(--theme-ui-colors-gray-2);color:var(--theme-ui-colors-gray-8);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-18eyij1 .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-18eyij1 .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-18eyij1 .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-18eyij1 .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-18eyij1 .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-18eyij1 .gatsby-highlight pre code{float:left;min-width:100%;}.css-18eyij1 .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-18eyij1 .gatsby-highlight pre[class~="language-javascript"]:before,.css-18eyij1 .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-18eyij1 .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-18eyij1 .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-18eyij1 .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-18eyij1 .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-18eyij1 .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-18eyij1 .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-18eyij1 .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-18eyij1 .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-18eyij1 .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-18eyij1 .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-18eyij1 .gatsby-highlight pre[class~="language-py"]:before,.css-18eyij1 .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-18eyij1 .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-18eyij1 .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-18eyij1 .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-18eyij1 .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-18eyij1 .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-18eyij1 .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-18eyij1 .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-18eyij1 .gatsby-highlight pre[class~='language-json']:before,.css-18eyij1 .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-18eyij1 .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-18eyij1 .gatsby-highlight pre[class~='language-hcl']:before{content:'hcl';background:#623ce4;color:var(--theme-ui-colors-white);}.css-18eyij1 .gatsby-highlight pre[class~='language-sql']:before{content:'sql';background:#e38c00;}.css-18eyij1 .gatsby-highlight>code[class*="language-"],.css-18eyij1 .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-18eyij1 .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-18eyij1 .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-18eyij1 .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1, 22, 39);}.css-18eyij1 .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-18eyij1 .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-18eyij1 .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-18eyij1 .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-18eyij1 .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-18eyij1 [data-name='live-preview'],.css-18eyij1 [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width: 640px){.css-18eyij1 [data-name='live-preview'],.css-18eyij1 [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width: 768px){.css-18eyij1 [data-name='live-preview'],.css-18eyij1 [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width: 1024px){.css-18eyij1 [data-name='live-preview'],.css-18eyij1 [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-18eyij1 .token-line{padding-right:1rem;}.css-18eyij1 .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-18eyij1 .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-18eyij1 .react-live-wrapper{position:relative;}.css-18eyij1 .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width: 640px){.css-18eyij1 .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 768px){.css-18eyij1 .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 1024px){.css-18eyij1 .react-live-wrapper .code-copy-button{right:-1rem;}}</style><main id="skip-nav" class=" css-18eyij1"><style data-emotion="css 1aue9xx">.css-1aue9xx{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:2.25rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-1aue9xx{font-size:3rem;}}@media screen and (min-width: 768px){.css-1aue9xx{font-size:3rem;}}@media screen and (min-width: 1024px){.css-1aue9xx{font-size:4rem;}}</style><h1 class="css-1aue9xx">Integrating AWS GuardDuty with Microsoft Teams</h1><style data-emotion="css 15ce8we">.css-15ce8we{color:var(--theme-ui-colors-secondary);margin-top:1rem;font-size:1rem;}.css-15ce8we a{color:var(--theme-ui-colors-secondary);}@media screen and (min-width: 640px){.css-15ce8we{font-size:1rem;}}@media screen and (min-width: 768px){.css-15ce8we{font-size:1.25rem;}}</style><p class="css-15ce8we"><time>Feb 4th 2021</time> — <a class="css-bpdkdn" href="/tags/aws">AWS</a>, <a class="css-bpdkdn" href="/tags/terraform">Terraform</a>, <a class="css-bpdkdn" href="/tags/tutorials">Tutorials</a> — <span>2<!-- --> min read</span></p><style data-emotion="css b56ay0">.css-b56ay0{margin-top:4rem;margin-bottom:4rem;}.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;box-shadow:rgba(0, 0, 0, 0.15) 0px 32px 32px 0px,rgba(0, 0, 0, 0.15) 0px 16px 16px 0px,rgba(0, 0, 0, 0.15) 0px 8px 8px 0px,rgba(0, 0, 0, 0.15) 0px 4px 4px 0px;}@media screen and (min-width: 640px){.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width: 768px){.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}</style><section class="css-b56ay0"><style data-emotion="css 1ccrm8j">.css-1ccrm8j{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-1ccrm8j{font-size:1rem;}}@media screen and (min-width: 768px){.css-1ccrm8j{font-size:1.25rem;}}</style><p class="css-1ccrm8j"><style data-emotion="css 1bw77fa">.css-1bw77fa{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1bw77fa:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://aws.amazon.com/guardduty/" class="css-1bw77fa">AWS GuardDuty</a> is a managed threat detection service that monitors malicious or unauthorized behaviors/activities related to AWS resources. Effectively it can be set up to act similarly to an IDS, providing a stream of <em class="css-0">findings</em> that can clue security analysts in on potential threats.</p><p class="css-1ccrm8j">Of course, exclusively reviewing these events through the AWS Console somewhat defeats their purpose... By the time you&#x27;ve logged in and seen that six-hour-old high severity finding, the threat has already had enough time to cause its intended damage.</p><p class="css-1ccrm8j">One reasonable solution is to forward those events to a more visible channel. In this post, I&#x27;ll demonstrate how you can utilize AWS services like Lambda and CloudWatch to pass these GuardDuty findings onto a communication tool like <a href="https://www.microsoft.com/en/microsoft-teams/group-chat-software" class="css-1bw77fa">Microsoft Teams</a>.</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:39.166666666666664%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJElEQVQoz3WQ606EMBBG91mEBWmnpZQWhGlhL+q6anz/t/kMNTZG1x8nc0tPZroTguCMgbcW1DTQUqCpKtRlmbn/FUVdQdT1H8qiwI5ki0tgfJxPeD8e8HZYcY0BzzzjGmMi5UvE0zzhdV0wKYIXDUYpMGwIgYEk6v0eu7K4wziOiMuCEEKGmRFjTH0OjJkZD9OUZs45KKUgpYQkSpFIodqE+7IEzzMiMzpjwPOU6sAbjCVG+E0gJTRRotUaiij1FMk8q742LHA6HnFYV3jnscaYRL21sJ1NkbYNbpCkRDnPwsfzGS+XCwbvEAMnettBCpH4fviTW/J8smk7eDdh8DMGzznv7QBF6qbwt1yr/IcFtNIwrU10xiVM26PV3b/n3mJb7hPYZfn9pxxPkAAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="An example GuardDuty alert on Teams." title="An example GuardDuty alert on Teams." src="/static/60a2e2146f2c2394e0200ae6de4f750a/7d769/guardduty-alert.png" srcSet="/static/60a2e2146f2c2394e0200ae6de4f750a/5243c/guardduty-alert.png 240w,/static/60a2e2146f2c2394e0200ae6de4f750a/ab158/guardduty-alert.png 480w,/static/60a2e2146f2c2394e0200ae6de4f750a/7d769/guardduty-alert.png 960w,/static/60a2e2146f2c2394e0200ae6de4f750a/87339/guardduty-alert.png 1440w,/static/60a2e2146f2c2394e0200ae6de4f750a/13e26/guardduty-alert.png 1630w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p><style data-emotion="css kih3f7">.css-kih3f7{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-kih3f7{font-size:2.25rem;}}@media screen and (min-width: 768px){.css-kih3f7{font-size:2.25rem;}}@media screen and (min-width: 1024px){.css-kih3f7{font-size:3rem;}}</style><h2 class="css-kih3f7">Anatomy of a Finding</h2><p class="css-1ccrm8j">Each GuardDuty finding is associated with a large number of useful <a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_findings-summary.html" class="css-1bw77fa">details</a>, often dependent on the type of the finding itself. These details include attributes like the name and severity of the finding, the region it occurred in, and the time it was last detected. The <em class="css-0">severity</em> of a finding is particularly interesting, providing us with a simple metric indicating importance. AWS defines severity levels using three distinct ranges:</p><style data-emotion="css 7ckq4h">.css-7ckq4h{width:100%;margin-top:2rem;margin-bottom:2rem;border-collapse:separate;border-spacing:0;}.css-7ckq4h th,.css-7ckq4h td{text-align:left;padding-top:4px;padding-bottom:4px;padding-right:4px;padding-left:0;border-color:var(--theme-ui-colors-muted);border-bottom-style:solid;}</style><table class="css-7ckq4h"><thead><tr class="css-0"><style data-emotion="css fcb6mo">.css-fcb6mo{vertical-align:bottom;border-bottom-width:2px;color:var(--theme-ui-colors-heading);}</style><th class="css-fcb6mo">Severity Level</th><th class="css-fcb6mo">Value Range</th></tr></thead><tbody><tr class="css-0"><style data-emotion="css 15msde0">.css-15msde0{vertical-align:top;border-bottom-width:1px;}</style><td class="css-15msde0">High</td><td class="css-15msde0">7.0 – 8.9</td></tr><tr class="css-0"><td class="css-15msde0">Medium</td><td class="css-15msde0">4.0 – 6.9</td></tr><tr class="css-0"><td class="css-15msde0">Low</td><td class="css-15msde0">0.1 – 3.9</td></tr></tbody></table><p class="css-1ccrm8j">As an example of how this could be used, we could filter out <em class="css-0">particularly</em> unimportant findings by ignoring anything with a severity less than 2.0.</p><h2 class="css-kih3f7">CloudWatch and Lambda</h2><p class="css-1ccrm8j"><a href="https://aws.amazon.com/cloudwatch/" class="css-1bw77fa">AWS CloudWatch</a> helpfully provides us with a <strong class="css-0">GuardDuty Finding</strong> event type for rules. Using this, we can easily have CloudWatch trigger a Lambda function for processing each finding. In terms of a Terraform resource, it could be represented as follows:</p><div class="gatsby-highlight" data-language="hcl"><pre class="prism-code language-hcl" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><style data-emotion="css dybovu">.css-dybovu{background-color:rgba(107,70,193,0.2);border:none;color:var(--theme-ui-colors-gray-2);cursor:pointer;font-size:14px;font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";letter-spacing:0.025rem;-webkit-transition:default;transition:default;position:absolute;top:0;right:0;z-index:1;border-radius:0 0 0 0.25rem;padding:0.25rem 0.6rem;}@media screen and (min-width: 640px){.css-dybovu{font-size:14px;}}@media screen and (min-width: 768px){.css-dybovu{font-size:16px;}}.css-dybovu[disabled]{cursor:not-allowed;}.css-dybovu:not([disabled]):hover{background-color:var(--theme-ui-colors-primary);color:var(--theme-ui-colors-white);}</style><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<style data-emotion="css 15vf505">.css-15vf505{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-hcl"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">resource &quot;aws_cloudwatch_event_rule&quot; &quot;forward_finding_rule&quot; {</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">  name        = &quot;forward-guardduty-finding-to-teams&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">  description = &quot;Triggers a lambda function whenever a GuardDuty finding is updated.&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">  event_pattern = &lt;&lt;EOF</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">{</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">  &quot;source&quot;: [</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">    &quot;aws.guardduty&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">  ],</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">  &quot;detail-type&quot;: [</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">    &quot;GuardDuty Finding&quot;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">  ],</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">  &quot;detail&quot;: {</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">    &quot;severity&quot;: [</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">      0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.0,</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">      1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.0,</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">      2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3, 3.0,</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">      3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4, 4.0,</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">      4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5, 5.0,</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">      5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6, 6.0,</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">      6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7, 7.0,</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">      7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8, 8.0,</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">      8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">    ]</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">  }</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">EOF</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">}</span></div></code></pre></div><p class="css-1ccrm8j">Note that the ugly block of severity levels is an unfortunate requirement of CloudWatch&#x27;s design. If a finding comes through with a severity that isn&#x27;t explicitly listed above, it won&#x27;t be forwarded to the Lambda function...</p><p class="css-1ccrm8j">Now onto the fun part. We can create an <a href="https://aws.amazon.com/lambda/" class="css-1bw77fa">AWS Lambda</a> function using any of the available languages. I&#x27;m going to use the <strong class="css-0">Python 3.8</strong> runtime because I think Python is perfect for these sorts of small stand-alone functions.</p><div class="gatsby-highlight" data-language="py"><pre class="prism-code language-py" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-py"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">lambda_handler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">    event_detail </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;detail&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> event_detail</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;severity&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">        </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">    card </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> create_card</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event_detail</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">    send_card</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">card</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></code></pre></div><p class="css-1ccrm8j">We can get the above-described finding details out of the handler&#x27;s <code class="css-0">event</code> parameter, as shown on line 2. This sub-dictionary contains all the information we need to filter on the severity and pass the finding onto Teams. In the example I&#x27;ve provided, I&#x27;m passing the details to a <code class="css-0">create_card(event_detail)</code> function to encode the message in a way Teams will understand. The result of this call is a dictionary that can be <em class="css-0">jsonified</em> and sent to a Teams webhook:</p><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-json"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;@type&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;MessageCard&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;@context&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;https://schema.org/extensions&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;correlationId&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;ed63439c-8efd-44af-847a-a15f3822cf92&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;summary&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;A summary of the message.&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;themeColor&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;9B59B6&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;title&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Message Title&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;sections&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;facts&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;name&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Finding ID&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;value&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;db49b33c711d380d2717e5bb7165e644&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;name&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Type&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;value&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Canary:EC2/Stateless.IntegTest&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;name&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Environment&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;value&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Development&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;name&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Region&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;value&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;us-east-1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property" style="color:rgb(128, 203, 196)">&quot;name&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Occurred At&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;value&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;2017-10-31T23:16:23.824Z&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;text&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;A detailed description of the finding.&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">  </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;potentialAction&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;@type&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;OpenUri&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;name&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Open in AWS Management Console&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">      </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;targets&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">          </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;os&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;default&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">          </span><span class="token property" style="color:rgb(128, 203, 196)">&quot;uri&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;https://us-east-1.console.aws.amazon.com/...&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></code></pre></div><h2 class="css-kih3f7">Now What?</h2><p class="css-1ccrm8j">At this point, we&#x27;ve got a Lambda function that we can do practically anything with. You could easily modify the example function I&#x27;ve written to post to other communication tools like Slack or to an incident response service like PagerDuty. You could even do something out there and automate your home lighting to match the severity of incoming events...</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:51.66666666666666%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC1ElEQVQozzWObUiTCQCA358RREcd2Wm2Vd5lq7m+Zq7cVulM97ZsX6X76J1Tt2nY5ia65bRvEqIffYjgr+iOfmQEh3LRcQqdV9wRmVdBZZ9ECKVJRc5ybk8k9Px6fj08wi29hfsGB89FL2/MAT7sDZJwNTHtiTJT3Uq6th18hyFwhLTvENPeVr5IUT45wkzYGxgt9zFSuo+7RRX8rd2NcFNv4UGJg5cmL+O2eiadYaY9LczUxsHfziurn/8MFYxaAky6I+BrJ1kT57PUzKfKRsYsdTwzSvxvqOAf3W6EQX059wyVs8F39v0k3BGS1THS/jZmvM08LHXRX1jOgNbMiCiR8kZJ+eJMV7WQcIYZt9bxXJS4W7yHG9pdCH9uEbm93c4To8RbW4CEO0yyuoVUoBV8McbtdVzRGOnTmfngCJGuiZHyfws2M+kI8sbs43GZk3+3Wbi+uQzhSn4RA9qdDBv28tLkYcJex5Q7RKqmhbT/IPhjXM030ltogUAb6drY7PmUK8g7m58X4j7uFFnpLxTpUW9H6FZqZmVAa2K42M4L0c2YtZZJZwPJqggpTxNDjgM8dIVAaiIpNZKo3M+YpZpnoouhYht/aY1cVm+jO0+DcHz5Gs4r1Py6XkdfwQ4G9bsYNth5anIzWuZiqqMLPn8hPTbBx9ARXpW5GBGdDBls3NhqondzCb9t1NGpzOfkLyqEUIaceHYuHTkqOhUFXFDpuKwu4pp2J4MbS3l/6Xe+8/rEOfrVJfyhE+nZVMzFDXq6VBpOrdpA+4rVNGavQJDmLca3YAnBjOVEM1dyWK6k4+f1nFVo6Fbq6N1q5VHbae43naCnwEhXnpYzSg2nFGqO5a7lYM5qwrKV1Gcto2pRFkL5nPnY5i7AMS8Dzw+Z+BfKaFiUQyQzl+hSJW2ydRzLUnF0iYq4fB3NciURmYKgLJf6pTnUZMmRFmdT8eNPmOcv5CuEVd4YPG+jEgAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="A red-colored light." title="A red-colored light." src="/static/b22d14eda330fb485b7b274ce13966ec/7d769/stressful-lighting.png" srcSet="/static/b22d14eda330fb485b7b274ce13966ec/5243c/stressful-lighting.png 240w,/static/b22d14eda330fb485b7b274ce13966ec/ab158/stressful-lighting.png 480w,/static/b22d14eda330fb485b7b274ce13966ec/7d769/stressful-lighting.png 960w,/static/b22d14eda330fb485b7b274ce13966ec/87339/stressful-lighting.png 1440w,/static/b22d14eda330fb485b7b274ce13966ec/88b03/stressful-lighting.png 1920w,/static/b22d14eda330fb485b7b274ce13966ec/a0f61/stressful-lighting.png 2926w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p><p class="css-1ccrm8j">You can find a nicely packaged version of all this code in my <a href="https://github.com/lbm/terraform-aws-guardduty-teams" class="css-1bw77fa">GitHub repository</a>. It includes a <a href="https://www.terraform.io" class="css-1bw77fa">Terraform</a> configuration, so you can get everything up and running for your organization within a couple of commands.</p></section></main><style data-emotion="css y7pay1">.css-y7pay1{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:1rem;}.css-y7pay1 a{color:var(--theme-ui-colors-secondary);-webkit-text-decoration:none;text-decoration:none;}.css-y7pay1 a:hover{color:var(--theme-ui-colors-heading);-webkit-text-decoration:underline;text-decoration:underline;}.css-y7pay1 a:focus{color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-y7pay1{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 768px){.css-y7pay1{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-y7pay1"><div>© <!-- -->2022<!-- --> by <!-- -->Lachlan Mitchell<!-- -->. All rights reserved.</div><div><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/main/themes/gatsby-theme-minimal-blog" class="css-1fmmdck">Theme</a> <!-- -->by<!-- --> <a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de?utm_source=minimal-blog&amp;utm_medium=Theme" class="css-1fmmdck">LekoArts</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/integrating-aws-guardduty-with-microsoft-teams";window.___webpackCompilationHash="a1d72af294ce649f5b71";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-ef87089b896dcabb4545.js"],"app":["/app-262d5f1ec61369e82811.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-b246faf5d0bcafe6a978.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-db3b0364a1159f4622cb.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-ef4772e5326ca7a723ca.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-60730867f24c7832cbab.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-a08f67e0597184025aa3.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-63246f289c80bb59bf8b.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-ad91b55cafcc5ba9982f.js"]};/*]]>*/</script><script src="/polyfill-ef87089b896dcabb4545.js" nomodule=""></script><script src="/app-262d5f1ec61369e82811.js" async=""></script><script src="/framework-dde9cca84a2a9d38363f.js" async=""></script><script src="/webpack-runtime-34cc8df6f2a0e03a810a.js" async=""></script></body></html>
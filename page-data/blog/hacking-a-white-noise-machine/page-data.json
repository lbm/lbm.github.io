{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/blog/hacking-a-white-noise-machine","result":{"data":{"post":{"slug":"/blog/hacking-a-white-noise-machine","title":"Hacking a White Noise Machine","date":"Sep 21st 2022","tags":[{"name":"Hardware","slug":"hardware"},{"name":"Tutorials","slug":"tutorials"}],"description":null,"canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Hacking a White Noise Machine\",\n  \"date\": \"2022-09-21T00:00:00.000Z\",\n  \"tags\": [\"Hardware\", \"Tutorials\"],\n  \"banner\": \"./hacking-a-white-noise-machine.jpg\",\n  \"slug\": \"/hacking-a-white-noise-machine\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I recently bought a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://medcursor.com/products/white-noise-machine-black\"\n  }, \"Medcursor White Noise Machine\"), \" in a desperate attempt to help my newborn son sleep longer through the night. At about \\xA52,500 on Amazon, it's a fairly affordable and sleek device that I'd have no problems recommending.\"), mdx(\"p\", null, \"Unfortunately, I'm really into the sound of rain and thunder and this particular device only comes with a single matching track... Additionally, the rain is quiet while the thunder is loud \\u2014 a bad mix when you're trying not to startle a sleeping baby.\"), mdx(\"p\", null, \"How are we going to fix this problem? Let's hack it.\"), mdx(\"h2\", null, \"Reconnaissance\"), mdx(\"p\", null, \"To start with, getting this thing open is like dealing with the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://hellraiser.fandom.com/wiki/Lament_Configuration\"\n  }, \"Lament Configuration\"), \". It turns out that the speaker grille hides the screws, and luckily it's not glued in place. Once you slide it off and remove the screws it's simply a matter of prying the shell apart (which is easier said than done).\"), mdx(\"p\", null, \"Inside the unit is a fairly simple multi-PCB design. The main circuit board that we care about is fitted on the side of the machine, aligned with the buttons.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"63.33333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADuUlEQVQ4yx3DezDUCQDA8V+D7Iq2rmmsjrTVqDynvVFY78NGONF53q1siTBaz4ZyF2cH6SWOqL2pdF1dyo25HpM5WZNXhTVhiWvlNCp359z9cf33vZn7zHwEG8k6qivLMA73MT1hYGrsOdMTI/TpH9J+s4WpF085mq9BsLBCtHoNotUSBHNLAoOD+OfdLD9cPk1pnoroiBDcPOQIkTFRtOouMNh9n5nxYUxGA7OTo7z/zcTz3i5+edhOVnYOgpkYC7E15mJrBHMR9o4yTONDPOvu4EThAbIOxePj44Nw5YqOx5336Gi7Sn/PA549fYxhdIBnw7086XvEjbZWUrMzsdogxVbm+P/1m2WsddxI20/fszg3ga6hkgunT6A9eQxhetrIv8tLHLl+hnVfJeB2Ppvdp7JQVGXiUK7C4ZsDfFyeinVNKtu+KyD2tpbEu1VE3vqawB9L6Tf28cerCWYnRxjUP0AI26PkM2U467OiEMpjcUpW4hu/F8/EcBSqfdidTUeoTUZ8Ro3FxQwcWwtxvlaEvK0Uj7Ziesa6+bBgYmF2nKY6LYIgrEAQi5AWxaFsKcE7KYKoxCicA3YRGhuOR3Meti05uDRr8Lh6DNcrxbhfK0b2bQ4yXS51PTf4e+4l715PMD9tQBCZWWIms8OpRUPKrRqc647gdykP28bDWDYeYpUuBzvdUVybcpE35ePakMsWXT6S+kxsatQk3znF8uuXvDWN8+f8NIKNaBUiRztczqqJbCgg6Fw20fUaQpvzUNTnYnVejbv2IB/VprGz4iDra9JwOZ5KYlkWgYVp5F6vZdFk5O2vYyzOTSJst5di42BLaHo42qoCUgoS0FbkEpEaRUL6fuyUnngr/ZGGeaKICMYu1Au5vwKvkCA2ubqhqa/grzczzE+N8n7WiBAg38G2zfbsjg8goehL/NIjSClOZVvKp/hlxLFhnwJv9T6k0b64qSJZG+nL1pS9yNQx7KnUcLC6hK6f77I0P8PCqwmEMIWcQE83XDc5IJVIWCO2YuUKM8TmK7FYYY7EWsJGxy3s/GQXwSFhJCYlU1xUyN2brYwP9jCk76KstISrly+y9GYG4XOlH/vD/YlT+hEe6IW33BX3HU5sd9qKk9NW/IMCKDpeRNOlBjo6bvNE38lQfw+GAT3DvV1MjgwyNzlGc2Mj1dpKBHVcGIcTI8hWRZOliiHjixgyVLFkpydxNCeNipOF6FrO0XHnOp3329E/ukdv10MG9Y8w9HUz/ryf18YXfFj+nYGBfv4Dw1piUXRSJBAAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"The main PCB.\",\n    \"title\": \"The main PCB.\",\n    \"src\": \"/static/a99bc1c7e8fad26a383a45f85145975b/7d769/main-pcb.png\",\n    \"srcSet\": [\"/static/a99bc1c7e8fad26a383a45f85145975b/5243c/main-pcb.png 240w\", \"/static/a99bc1c7e8fad26a383a45f85145975b/ab158/main-pcb.png 480w\", \"/static/a99bc1c7e8fad26a383a45f85145975b/7d769/main-pcb.png 960w\", \"/static/a99bc1c7e8fad26a383a45f85145975b/832a9/main-pcb.png 1008w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, \"Unfortunately, a lot of the ICs on this device have no usable markings, so it's difficult to identify what is what. The 8-pin SOIC labeled \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"U5\"), \" is a good candidate for a flash chip, so let's start there. I connected a CH341A programmer to the chip with a SOIC-8 test clip and gave it a whirl with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"flashrom\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-noLineNumbers\"\n  }, \"$ flashrom --programmer ch341a_spi -r dump.bin\\nflashrom v1.2 on Darwin 21.5.0 (x86_64)\\nflashrom is free software, get the source code at https://flashrom.org\\n\\nCalibrating delay loop... OK.\\nFound Generic flash chip \\\"unknown SPI chip (RDID)\\\" (0 kB, SPI) on ch341a_spi.\\n===\\nThis flash part has status NOT WORKING for operations: PROBE READ ERASE WRITE\\nThe test status of this chip may have been updated in the latest development\\nversion of flashrom. If you are running the latest development version,\\nplease email a report to flashrom@flashrom.org if any of the above operations\\nwork correctly for you with this flash chip. Please include the flashrom log\\nfile for all operations you tested (see the man page for details), and mention\\nwhich mainboard or programmer you tested in the subject line.\\nThanks for your help!\\nRead is not working on this chip. Aborting.\\n\")), mdx(\"p\", null, \"Hmm, no luck. It would have been nice for it to work on the first go, but it seems this is some unsupported generic chip. Running the above command again with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-VVV\"), \" flag gives us some more info.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-noLineNumbers\"\n  }, \"$ flashrom --programmer ch341a_spi -r dump.bin -VVV\\n...\\nRDID returned 0xd8 0x40 0x18. RDID byte 0 parity violation\\nprobe_spi_rdid_generic: id1 0xd8, id2 0x4018\\n...\\n\")), mdx(\"p\", null, \"Now we're getting somewhere. When asked for an RDID, the chip is returning \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0xD8\"), \" for id1 and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0x4018\"), \" for id2. \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0xD8\"), \" is actually an invalid manufacturer ID (as shown by the parity violation warning), so we have even more evidence that this chip is not made by a well-known vendor. The device ID is interesting though since it matches the relatively popular \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.winbond.com/hq/product/code-storage-flash-memory/serial-nor-flash/?__locale=en&partNo=W25Q128FV\"\n  }, \"W25Q128FV\"), \" flash chip by Winbond. Just a coincidence, or something more?\"), mdx(\"h2\", null, \"White Lies\"), mdx(\"p\", null, \"If we were to assume that our unknown chip was mostly identical to the Winbond W25Q128FV, then we could simply edit the source of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"flashrom\"), \" and force it to recognize them as one and the same.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-c:title=flashchips.h\",\n    \"metastring\": \"noLineNumbers {5}\",\n    \"noLineNumbers\": true,\n    \"{5}\": true\n  }, \"/*\\n * W25X chips are SPI, first byte of device ID is memory type, second\\n * byte of device ID is related to log(bitsize).\\n */\\n#define WINBOND_NEX_ID        0xD8   /* Winbond (ex Nexcom) serial flashes */\\n#define WINBOND_NEX_W25Q128_V 0x4018 /* W25Q128BV; W25Q128FV in SPI mode (default) */\\n\")), mdx(\"p\", null, \"Modifying the Winbond manufacturer ID constant to match \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0xD8\"), \" will ensure that our generic chip is forcibly recognized as the W25Q128FV. After recompiling it, we just need to try another read with the freshly built custom \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"flashrom\"), \" binary.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-noLineNumbers\",\n    \"metastring\": \"{10}\",\n    \"{10}\": true\n  }, \"$ CONFIG_RAYER_SPI=no CONFIG_ENABLE_LIBPCI_PROGRAMMERS=no make\\n...\\nmake[1]: Nothing to be done for `all'.\\n\\n$ ./flashrom --programmer ch341a_spi -r dump.bin\\nflashrom v1.2 on Darwin 21.5.0 (x86_64)\\nflashrom is free software, get the source code at https://flashrom.org\\n\\nCalibrating delay loop... OK.\\nFound Winbond flash chip \\\"W25Q128.V\\\" (16384 kB, SPI) on ch341a_spi.\\nReading flash... done.\\n\")), mdx(\"h2\", null, \"Resampling\"), mdx(\"p\", null, \"Nice! We've successfully dumped the contents of the flash chip. Now let's figure out what we've got. If you run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"file\"), \" on the dump, you'll see we have a FAT16 formatted image.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-noLineNumbers\"\n  }, \"$ file dump.bin\\ndump.bin: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID \\\"MSDOS5.0\\\",\\nsectors/cluster 32, reserved sectors 4, root entries 512, Media descriptor\\n0xf8, sectors/FAT 30, sectors/track 63, heads 255, hidden sectors 32, sectors\\n243680 (volumes > 32 MB), serial number 0xd2e006c3, unlabeled, FAT (16 bit)\\n\")), mdx(\"p\", null, \"On macOS, you can actually just give the dump a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".img\"), \" extension, double click on it, and the image will be mounted and writable. If you're okay with modifying the image in place, then it's a quick and simple approach.\"), mdx(\"p\", null, \"The image itself is filled with 29 MP3 files. Now comes the hard part; finding some suitable sound samples that seamlessly loop. \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://freesound.org/\"\n  }, \"freesound.org\"), \" is a good place to go hunting. I was lucky in that all the loops I found managed to fit within the image without any resizing. Of course, you could make it a bit bigger if needed (remember though, we don't have any hard evidence about the true capacity of the flash chip).\"), mdx(\"p\", null, \"Now you just need to write it back!\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"63.33333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADrklEQVQ4yx3M7VPTBQDA8d9dpwl0gU+goIg8hhA+AIciKAnKwx4YbEOeHBBIbCROYBtsY7CxiW7oQCHGw3gwEKECDAIOyzS9S7Qr6/Chuu6863+o3n27evF5+xFOHk/iapuaWwMOHMY6MtJTEYvzSc/IZHvgbjZt9iE9fi9xMft5OyKG0PdikclyaW6u44rDwDVnK9e7zVjMF1lZmkVQ5qbiuiSmWpnBuYpKFldW+fufv/jjzRuM5g58/d4leGcAkfvDCA7eR2OTDpPmAj6btrArKIjYqAiyT58kv0CCwaBFyEpLZLyjmPpKGUXlFdi6LmOx2rFdsSLSVPBOwA62bgtkd0gomadO8OrVLyyNDLFnbzgx8YcIj4xGEATE2Rl0tVQhHIgKp9egoFZ5gu0BW9m1O4SAbUGcOnKQ0sF2EhV5hOwMJiwihvIyBT//+JTFQRcNZWeokGdTppRSpSrGduEsnWoRwtGkw3RpC7Co80mIDsfPx4+gwED8N/nw/tkcDpeI2e7rT3pyPA7TR/z262vueXu4qc1kwiRmsOkMn7YXMdych0cnRdDXV+BulHJDJ8OgyuJoXDg7/APwe2szCQmxJGalk5scha4okeFuHb+/fs2r7x8y66phyi5nxi5ntlPBtE3JqFGGcP2ymWGnntu9eqZddXhaFdRIUkiK3EOY7xbSqvKRq3LQiuIZ6b/K07VlXr7YYP2raYYMuYyZJEx2FHLHrmRIL0ZwNavoMdVys/MSXreFiR4jj5a8PFi5g7WhBl1KHKXxoZQci+Sm00iftY3736wx7XHySVMeg3oRIwYREy0inOczEO6Nd7LkMTPXp+eWS0uPRc3n06P89PwZL1884c/GSqazUlAXHkdTlkdjaREj/TZu6GV4DBI8egmjrRImzfmMGUQI5oYq7E3V9FrqGXfpmBtow2OtpbWuiPaPy3C3anGbW1CUyEk+X0nskUNkJscxYTvLbFcpXqOMKUsBM9ZCptqkCFJ5MbnSQrLzJKSmpnEgLoGL1cXc7dcx1FaOta4Ak6YU9bkPaDZLOHgkhn1h0TgtdfS1KPiy+xwznUXM/semQFheXWZuYZ7bM3dwud3UqBvo0F9g1dvB3I1G5t0aJu3VXNXk4NIco1NfToWqhDGnhnGLkkX3h9ztVv0fzzuUCN89fsT6+hPuf3ufZz88ZWPjOQ++GGZ11M7aqJW1kTa+HrMw2l5Of3MhKwNNLPQ18viWkYdeHYs9ahau1TDvquQzRwn/AiRxTbCCaMxFAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"A CH341A programmer connected to the white noise machine's flash chip.\",\n    \"title\": \"A CH341A programmer connected to the white noise machine's flash chip.\",\n    \"src\": \"/static/dd793a741851e458e695465239219052/7d769/ch341a-programmer.png\",\n    \"srcSet\": [\"/static/dd793a741851e458e695465239219052/5243c/ch341a-programmer.png 240w\", \"/static/dd793a741851e458e695465239219052/ab158/ch341a-programmer.png 480w\", \"/static/dd793a741851e458e695465239219052/7d769/ch341a-programmer.png 960w\", \"/static/dd793a741851e458e695465239219052/832a9/ch341a-programmer.png 1008w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"h2\", null, \"Final Thoughts\"), mdx(\"p\", null, \"I hope you were able to get something out of this post! I didn't get into the nitty-gritty of how to do things, and that's mainly because I wanted this to be more of a demonstration than a tutorial. Hopefully, you can see that hacking consumer electronics can (sometimes) be incredibly easy! In this case, I was able to take an already decent product and further customize it to suit my personal needs. Make your purchases work for you, there's no need to settle for what came out of the box.\"), mdx(\"p\", null, \"Could I have just bought a Bluetooth speaker and streamed \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.youtube.com/watch?v=mPZkdNFkNps\"\n  }, \"YouTube\"), \" to it? Sure, but where's the fun in that?\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"I recently bought a  Medcursor White Noise Machine  in a desperate attempt to help my newborn son sleep longer through the night. At about…","timeToRead":3,"banner":{"childImageSharp":{"resize":{"src":"/static/610cfcbf8799a23a0bbc0a2baf9f780f/a6c62/hacking-a-white-noise-machine.jpg"}}}}},"pageContext":{"slug":"/blog/hacking-a-white-noise-machine","formatString":"MMM Do YYYY"}},"staticQueryHashes":["2744905544","3090400250","318001574"]}